---
title: RFC 6749
date: 2022-07-26 19:56:44
tags:
---

OAuth 定义了四种授予类型:

- authorization code，授权码
- implicit，隐藏式
- resource owner password credentials，密码
- client credentials，凭证式


## resource owner password credentials，密码

A 网站直接要求用户提供 B 网站的用户名和密码。拿到之后，A 直接向 B 请求令牌。

## client credentials，客户端凭证式

适用于没有前端的命令行应用。

这种方式给出的令牌，是针对第三方应用的，而不是针对用户的，即有可能多个用户共享同一个令牌。

企业微信的 access_token 获取类似于这种方式


# 10. Security Considerations

## 10.4. Refresh Tokens

Authorization Server 可以（MAY）给 Web 应用客户端和本地应用客户端颁发 Refresh Token。

Refresh Token 必须（MUST）在运输和存储的过程中保密，并且仅仅在 Authorization Server 和颁发了 Refresh Token 的客户端之间共享。Authorzation Server 必须（MUST） 维护 Refresh Token 和颁发了 Refresh Token 的客户端之间的绑定关系。Refresh Token 必须（MUST）只能使用 TLS 传输。??

每当客户身份可以验证时，Authorzation Server 必须（MUST）验证 Refresh Token 和客户身份之间的绑定关系。当无法进行客户端认证时，Authorization Server 应当（SHOULD）调配其他方案，以检测 Refresh Token 滥用。

例如，Authorization Server 可以使用 Refresh Token 循环，每个 access Token 刷新响应就在循环中颁发一个新的 Refresh Token。前一个 Refresh Token 失效，但是还会被 Authorization Server 保留。如果一个 Refresh Token 被渗透了，随后都被攻击者和合法客户端使用，其中一个会出现无效的 Refresh Token，它将告知授权服务器违规。

*授权服务器*必须确保 Refresh Token 不能被生成，篡改，或者猜测以生成有效的刷新令牌。